<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styleII.css">
    <script src="https://kit.fontawesome.com/b99e675b6e.js"></script>
    <link rel="icon" href="img/Logo.jpg">
    <title>Principal</title>
</head>
<body>
    <div class="wrapper">
        <div class="sidebar">
            <div>
                <a href="Principal.html"><img src="1.png" alt=""></a>        
                <a href="Notificaçao.html"><img src="2.png" alt=""></a>        
                <a href="Cuidador.html"><img src="3.png" alt=""></a>        
            </div>
            <div class="perfil">
                <img class="logo" src="recover.png" alt="">           
            </div>
        </div>
        <div class="main_content">
            <style>
                .wrapper .main_content .header {
                    background: #B08A74;
                }
            </style>
            <div class="header">Perfil dos Idosos </div>
            <div class="info">
                <div class="profile-container">
                    <div class="add-profile" id="add-profile">
                        <img src="4.png" alt=""><p>Cadastrar Idoso</p>
                    </div>
                    <div class="profile-list">
                        <!-- Perfis vão aqui -->
                    </div>
                </div>
           </div>
        </div>
        <div class="popup" id="popup">
            <div class="popup-content">
                <span class="material-symbols-outlined close" id="close-popup">close</span>
                <h2 id="popup-titulo">Adicionar Perfil</h2>
                <form id="perfil-form">
                    <input type="hidden" id="profile-id">
                    <label for="nome">Nome:</label>
                    <input type="text" id="nome" required>
                    <label for="apelido">Apelido:</label>
                    <input type="text" id="apelido" required>
                    <label for="ddn">Data de Nascimento:</label>
                    <input type="date" id="ddn" required>
                    <label for="deficiencia">Deficiência:</label>
                    <select id="deficiencia" required>
                        <option value="">Selecione</option>
                        <option value="sim">Sim</option>
                        <option value="nao">Não</option>
                    </select>
                    <div id="deficiencia-opcoes" style="display: none;">
                        <label for="deficiencia-tipo">Tipo de Deficiência:</label>
                        <select id="deficiencia-tipo">
                            <option value="">Selecione</option>
                            <option value="diabete">Diabete</option>
                            <option value="alzhaimer">Alzheimer</option>
                            <option value="catarata">Catarata</option>
                            <option value="outras">Outras</option>
                        </select>
                        <div id="outras-doencas" style="display: none;">
                            <label for="outras">Especifique:</label>
                            <input type="text" id="outras" placeholder="Descreva outra deficiência">
                        </div>
                    </div>
                    <button type="submit" id="submit-btn">Cadastrar</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const addProfileBtn = document.getElementById('add-profile');
            const popup = document.getElementById('popup');
            const closePopupBtn = document.getElementById('close-popup');
            const profileList = document.querySelector('.profile-list');
            const deficienciaSelect = document.getElementById('deficiencia');
            const deficienciaOpcoes = document.getElementById('deficiencia-opcoes');
            const deficienciaTipoSelect = document.getElementById('deficiencia-tipo');
            const outrasDoencasDiv = document.getElementById('outras-doencas');

            let profiles = []; // Array para armazenar perfis

            addProfileBtn.addEventListener('click', function() {
                // Limpar campos do formulário para novo perfil
                document.getElementById('perfil-form').reset();
                deficienciaOpcoes.style.display = 'none'; // Esconder opções de deficiência
                popup.style.display = 'flex'; // Exibe o popup
            });

            closePopupBtn.addEventListener('click', function() {
                popup.style.display = 'none'; // Oculta o popup
            });

            // Fecha o popup se o usuário clicar fora dele
            window.addEventListener('click', function(event) {
                if (event.target === popup) {
                    popup.style.display = 'none';
                }
            });

            // Exibe ou oculta opções de deficiência
            deficienciaSelect.addEventListener('change', function() {
                if (this.value === 'sim') {
                    deficienciaOpcoes.style.display = 'block';
                } else {
                    deficienciaOpcoes.style.display = 'none';
                    deficienciaTipoSelect.value = '';
                    outrasDoencasDiv.style.display = 'none';
                }
            });

            // Exibe ou oculta caixa de mensagem para outras deficiências
            deficienciaTipoSelect.addEventListener('change', function() {
                if (this.value === 'outras') {
                    outrasDoencasDiv.style.display = 'block';
                } else {
                    outrasDoencasDiv.style.display = 'none';
                }
            });

            // Adiciona novo perfil
            document.getElementById('perfil-form').addEventListener('submit', function(event) {
                event.preventDefault();
                
                const nome = document.getElementById('nome').value;
                const apelido = document.getElementById('apelido').value;
                const ddn = document.getElementById('ddn').value;
                const deficiencia = document.getElementById('deficiencia').value;
                const deficienciaTipo = document.getElementById('deficiencia-tipo').value;
                const outras = document.getElementById('outras').value;
                
                let deficienciaDetalhes = '';
                if (deficiencia === 'sim') {
                    if (deficienciaTipo === 'outras' && outras) {
                        deficienciaDetalhes = `Outras: ${outras}`;
                    } else {
                        deficienciaDetalhes = deficienciaTipo;
                    }
                }

                const profileId = document.getElementById('profile-id').value;
                
                if (profileId) {
                    // Editar perfil existente
                    const profileIndex = profiles.findIndex(profile => profile.id === profileId);
                    if (profileIndex !== -1) {
                        profiles[profileIndex] = { id: profileId, nome, apelido, ddn, deficiencia: deficienciaDetalhes };
                    }
                } else {
                    // Adicionar novo perfil
                    const newProfile = {
                        id: Date.now().toString(), // Gera um ID único para o perfil
                        nome,
                        apelido,
                        ddn,
                        deficiencia: deficienciaDetalhes
                    };
                    profiles.push(newProfile);
                }

                updateProfileList();
                popup.style.display = 'none';
            });

            function updateProfileList() {
                profileList.innerHTML = profiles.map(profile => `
                    <div class="profile-item">
                        <p><strong>Nome:</strong> ${profile.nome}</p>
                        <p><strong>Apelido:</strong> ${profile.apelido}</p>
                        <p><strong>Data de Nascimento:</strong> ${profile.ddn}</p>
                        <p><strong>Deficiência:</strong> ${profile.deficiencia || 'Nenhuma'}</p>
                        <button onclick="editProfile('${profile.id}')">Editar</button>
                    </div>
                `).join('');
            }

            window.editProfile = function(profileId) {
                const profile = profiles.find(profile => profile.id === profileId);
                if (profile) {
                    document.getElementById('nome').value = profile.nome;
                    document.getElementById('apelido').value = profile.apelido;
                    document.getElementById('ddn').value = profile.ddn;
                    document.getElementById('deficiencia').value = profile.deficiencia ? 'sim' : 'nao';
                    document.getElementById('deficiencia-tipo').value = profile.deficiencia ? profile.deficiencia : '';
                    document.getElementById('outras').value = profile.deficiencia.includes('Outras:') ? profile.deficiencia.split('Outras: ')[1] : '';
                    document.getElementById('profile-id').value = profile.id;
                    deficienciaOpcoes.style.display = profile.deficiencia ? 'block' : 'none';
                    outrasDoencasDiv.style.display = profile.deficiencia.includes('Outras:') ? 'block' : 'none';
                    popup.style.display = 'flex';
                }
            };
        });
    </script>
</body>
</html>
